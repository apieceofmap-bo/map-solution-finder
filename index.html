<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map Solutions Finder - A Piece of Map</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #fffced;
        }
        .main-color {
            color: #285a84;
        }
        .accent-color {
            color: #85c872;
        }
        .bg-main {
            background-color: #285a84;
        }
        .bg-accent {
            background-color: #85c872;
        }
        .border-main {
            border-color: #285a84;
        }
        .tier-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        .tier-premium { background-color: #fbbf24; color: #78350f; }
        .tier-standard { background-color: #60a5fa; color: #1e3a8a; }
        .tier-basic { background-color: #9ca3af; color: #1f2937; }
    </style>
</head>
<body class="min-h-screen p-8">
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        const { useState } = React;

        // ========================================
        // CONFIGURATION
        // ========================================
        const CONFIG = {
            API_ENDPOINT: 'https://map-solutions-api-ranltu7hoq-du.a.run.app/api/recommend',
            API_KEY: '',
            DEMO_MODE: false,
            DEMO_DELAY: 1500
        };

        // Lucide Icons
        const Building2 = () => (
            <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/>
                <path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/>
                <path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/>
                <path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/>
            </svg>
        );

        const MapPin = () => (
            <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/>
                <circle cx="12" cy="10" r="3"/>
            </svg>
        );

        const Code = () => (
            <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="16 18 22 12 16 6"/>
                <polyline points="8 6 2 12 8 18"/>
            </svg>
        );

        const TrendingUp = () => (
            <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/>
                <polyline points="16 7 22 7 22 13"/>
            </svg>
        );

        const Globe = () => (
            <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <line x1="2" y1="12" x2="22" y2="12"/>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
        );

        const Loader2 = () => (
            <svg className="w-5 h-5 animate-spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
            </svg>
        );

        const ExternalLink = () => (
            <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                <polyline points="15 3 21 3 21 9"/>
                <line x1="10" y1="14" x2="21" y2="3"/>
            </svg>
        );

        const CheckCircle = () => (
            <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
        );

        const AlertCircle = () => (
            <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
        );

        // Provider colors
        const getProviderColor = (provider) => {
            const colors = {
                'google_maps': 'bg-blue-500',
                'mapbox': 'bg-purple-500',
                'here_technologies': 'bg-green-500'
            };
            return colors[provider] || 'bg-gray-500';
        };

        const getProviderName = (provider) => {
            const names = {
                'google_maps': 'Google Maps',
                'mapbox': 'Mapbox',
                'here_technologies': 'HERE Technologies'
            };
            return names[provider] || provider;
        };

        function MapSolutionsFinder() {
            const [formData, setFormData] = useState({
                useCase: '',
                mapFeatures: '',
                productParts: '',
                monthlyRequests: '',
                targetRegion: ''
            });
            const [loading, setLoading] = useState(false);
            const [result, setResult] = useState(null);
            const [error, setError] = useState(null);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setLoading(true);
                setError(null);
                
                const requestPayload = {
                    use_case: formData.mapFeatures,
                    service_regions_countries: formData.targetRegion,
                    monthly_api_requests: parseInt(formData.monthlyRequests) || 0,
                    target_industry: formData.useCase,
                    application: formData.productParts
                };

                try {
                    console.log('ðŸ“¤ Sending request to:', CONFIG.API_ENDPOINT);
                    console.log('ðŸ“¦ Payload:', requestPayload);

                    const headers = { 'Content-Type': 'application/json' };
                    if (CONFIG.API_KEY) {
                        headers['Authorization'] = `Bearer ${CONFIG.API_KEY}`;
                    }

                    const response = await fetch(CONFIG.API_ENDPOINT, {
                        method: 'POST',
                        headers: headers,
                        body: JSON.stringify(requestPayload)
                    });

                    console.log('ðŸ“¥ Response status:', response.status);

                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`API request failed (${response.status}): ${errorText}`);
                    }

                    const data = await response.json();
                    console.log('âœ… Response data:', data);
                    
                    setResult(data);
                    
                } catch (err) {
                    console.error('âŒ Error calling backend API:', err);
                    setError(err.message);
                } finally {
                    setLoading(false);
                }
            };

            const handleInputChange = (field, value) => {
                setFormData(prev => ({ ...prev, [field]: value }));
            };

            return (
                <div className="max-w-7xl mx-auto">
                    {/* Error Alert */}
                    {error && (
                        <div className="bg-red-50 border-l-4 border-red-400 p-4 mb-6">
                            <div className="flex">
                                <AlertCircle />
                                <div className="ml-3">
                                    <p className="text-sm text-red-700">
                                        <strong>Error:</strong> {error}
                                    </p>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Header */}
                    <div className="text-center mb-12">
                        <div className="flex items-center justify-center gap-3 mb-4">
                            <div className="w-12 h-12 bg-gradient-to-br from-green-400 to-green-600 rounded-lg flex items-center justify-center">
                                <MapPin />
                            </div>
                            <h1 className="text-4xl font-bold main-color">Map Solutions Finder</h1>
                        </div>
                        <p className="text-xl main-color">
                            Discover your ideal map solutions with <span className="font-bold accent-color">A Piece of Map</span>
                        </p>
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        {/* Left Panel - Form */}
                        <div className="bg-white rounded-lg shadow-lg p-8">
                            <h2 className="text-2xl font-bold main-color mb-6">
                                What would you like to make with maps?
                            </h2>

                            <form onSubmit={handleSubmit} className="space-y-6">
                                <div>
                                    <label className="flex items-center gap-2 text-sm font-medium main-color mb-2">
                                        <Building2 />
                                        Choose your use case or target industry.
                                    </label>
                                    <input
                                        type="text"
                                        value={formData.useCase}
                                        onChange={(e) => handleInputChange('useCase', e.target.value)}
                                        placeholder="e.g. Ride-hailing, Taxi service, Logistics & Delivery, Real-estate, etc."
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                        required
                                    />
                                </div>

                                <div>
                                    <label className="flex items-center gap-2 text-sm font-medium main-color mb-2">
                                        <MapPin />
                                        Describe map features you need
                                    </label>
                                    <textarea
                                        value={formData.mapFeatures}
                                        onChange={(e) => handleInputChange('mapFeatures', e.target.value)}
                                        placeholder="e.g. Multi-stop route optimization, Real-time routing and ETA calculation, Store locator, etc."
                                        rows="3"
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                        required
                                    />
                                </div>

                                <div>
                                    <label className="flex items-center gap-2 text-sm font-medium main-color mb-2">
                                        <Code />
                                        Which parts of your product (service) requires map solutions?
                                    </label>
                                    <input
                                        type="text"
                                        value={formData.productParts}
                                        onChange={(e) => handleInputChange('productParts', e.target.value)}
                                        placeholder="e.g. Backend Operations, End-user or Driver App, Web Dashboard, others."
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                        required
                                    />
                                </div>

                                <div>
                                    <label className="flex items-center gap-2 text-sm font-medium main-color mb-2">
                                        <TrendingUp />
                                        What are your expected number of monthly user, journey, or API requests?
                                    </label>
                                    <input
                                        type="number"
                                        value={formData.monthlyRequests}
                                        onChange={(e) => handleInputChange('monthlyRequests', e.target.value)}
                                        placeholder="Number of Monthly API Requests (or Journeys or Users) after 6 months from launch."
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                        required
                                    />
                                </div>

                                <div>
                                    <label className="flex items-center gap-2 text-sm font-medium main-color mb-2">
                                        <Globe />
                                        Which country or region will you target?
                                    </label>
                                    <input
                                        type="text"
                                        value={formData.targetRegion}
                                        onChange={(e) => handleInputChange('targetRegion', e.target.value)}
                                        placeholder="e.g. USA, Europe, Thailand, Southeast Asia, Singapore..."
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                        required
                                    />
                                </div>

                                <button
                                    type="submit"
                                    disabled={loading}
                                    className="w-full bg-main text-white py-3 px-6 rounded-lg font-medium hover:opacity-90 disabled:opacity-50 flex items-center justify-center gap-2 transition-opacity"
                                >
                                    {loading ? (
                                        <>
                                            <Loader2 />
                                            Analyzing your requirements...
                                        </>
                                    ) : (
                                        'Get Your Personalized Recommendations'
                                    )}
                                </button>
                            </form>
                        </div>

                        {/* Right Panel - Results */}
                        <div className="bg-white rounded-lg shadow-lg p-8 overflow-y-auto" style={{maxHeight: '800px'}}>
                            {!result ? (
                                <div className="flex items-center justify-center h-full">
                                    <div className="text-center">
                                        <MapPin />
                                        <p className="text-gray-500 mt-4">
                                            Fill out the form to discover your ideal map solution
                                        </p>
                                    </div>
                                </div>
                            ) : (
                                <div className="space-y-6">
                                    {/* Provider Header */}
                                    <div className={`${getProviderColor(result.provider)} text-white rounded-lg p-6`}>
                                        <h3 className="text-2xl font-bold mb-2">
                                            {getProviderName(result.provider)}
                                        </h3>
                                        <p className="text-sm opacity-90">
                                            Recommended provider for your use case
                                        </p>
                                    </div>

                                    {/* Primary Products */}
                                    {result.primary_products && result.primary_products.length > 0 && (
                                        <div>
                                            <h4 className="text-lg font-bold main-color mb-4 flex items-center gap-2">
                                                <CheckCircle />
                                                Essential Products ({result.primary_products.length})
                                            </h4>
                                            <div className="space-y-4">
                                                {result.primary_products.map((product, idx) => (
                                                    <div key={idx} className="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                                                        <div className="flex justify-between items-start mb-2">
                                                            <h5 className="font-bold main-color">{product.name}</h5>
                                                            {product.tier && (
                                                                <span className={`tier-badge tier-${product.tier}`}>
                                                                    {product.tier}
                                                                </span>
                                                            )}
                                                        </div>
                                                        <p className="text-sm text-gray-600 mb-2">{product.description}</p>
                                                        {product.reason && (
                                                            <p className="text-sm text-green-700 mb-2">
                                                                âœ“ {product.reason}
                                                            </p>
                                                        )}
                                                        {product.doc_url && (
                                                            <a 
                                                                href={product.doc_url} 
                                                                target="_blank" 
                                                                rel="noopener noreferrer"
                                                                className="inline-flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800"
                                                            >
                                                                <ExternalLink />
                                                                View Documentation
                                                            </a>
                                                        )}
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}

                                    {/* Optional Products */}
                                    {result.optional_products && result.optional_products.length > 0 && (
                                        <div>
                                            <h4 className="text-lg font-bold main-color mb-4">
                                                Optional Products ({result.optional_products.length})
                                            </h4>
                                            <div className="space-y-3">
                                                {result.optional_products.map((product, idx) => (
                                                    <div key={idx} className="border border-gray-200 rounded-lg p-4 bg-gray-50">
                                                        <div className="flex justify-between items-start mb-2">
                                                            <h5 className="font-semibold main-color text-sm">{product.name}</h5>
                                                            {product.tier && (
                                                                <span className={`tier-badge tier-${product.tier}`}>
                                                                    {product.tier}
                                                                </span>
                                                            )}
                                                        </div>
                                                        <p className="text-xs text-gray-600 mb-2">{product.description}</p>
                                                        {product.doc_url && (
                                                            <a 
                                                                href={product.doc_url} 
                                                                target="_blank" 
                                                                rel="noopener noreferrer"
                                                                className="inline-flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800"
                                                            >
                                                                <ExternalLink />
                                                                Documentation
                                                            </a>
                                                        )}
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}

                                    {/* Summary */}
                                    {result.total_count && (
                                        <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                            <p className="text-sm text-gray-700">
                                                <strong>Total Products:</strong> {result.total_count} API products recommended
                                            </p>
                                        </div>
                                    )}
                                </div>
                            )}
                        </div>
                    </div>

                    {/* Footer */}
                    <div className="text-center mt-12 text-sm text-gray-500">
                        <p>Â© 2024 A Piece of Map Inc. All rights reserved.</p>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<MapSolutionsFinder />, document.getElementById('root'));
    </script>
</body>
</html>
